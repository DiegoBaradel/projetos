const botaoJogar = document.getElementById('botao-iniciar')
botaoJogar.addEventListener('click', iniciar)

const botaoTentativa = document.getElementById('botao-enviar')
botaoTentativa.addEventListener('click', verificarNumero)


let numeroAleatorio = []
let numeroSecreto = []
let tentativa = 8

function focar(element, num){
    let arrey = document.getElementsByClassName('numero-secreto')
    if (arrey.value != element.value) { 
        if(num == arrey.length-1){
            arrey[0].focus()
        }
        else{
            arrey[num+1].focus()
        }
      }
    
}
function verificarNumero(){
    tentativa--
    const numero = document.getElementsByClassName('numero-secreto')
    escreverTr()
    
    for(let index=0; index<numero.length; index++){
        
        if(Number(numero[index].value) >= 0 && Number(numero[index].value) < 10){
        
            numeroSecreto.push(Number(numero[index].value))
            numeroExiste(index)

        }
        
        else {
        
            document.getElementById('inicio-fim').style.display='block'
            
        }
    }
    
    document.getElementById('tentativas-restantes').innerHTML = tentativa
    
    if(JSON.stringify(numeroAleatorio)==JSON.stringify(numeroSecreto)){
        ganhar()
    }
    else if(tentativa<=0){
        perder()
    }
    else{

    }
    resetar(numero)
}



function iniciar(){
    finalizar()
    document.getElementById('dica').innerHTML = 'Dica'
    for(let index = 0; index < 4; ){
    let aleatorio = Math.floor(Math.random() * 9)
    if (numeroAleatorio.indexOf(aleatorio) == -1){
        numeroAleatorio.push(aleatorio)
        index++  
    }
    }
    document.getElementById('inicio-fim').style.display='none'
}


function numeroExiste(index){
    if(numeroAleatorio[index] == numeroSecreto[index]){
        escreverTd(1)
    }
    else if(numeroAleatorio.indexOf(numeroSecreto[index]) != -1 ){
        escreverTd(2)
    }
    else{
        escreverTd(3)
    }
}

function escreverTr(){
    let tr = document.createElement('tr')
    tr.classList.add('alvo')
    document.getElementById('tabela').appendChild(tr)
}

function escreverTd(num){
    let index = document.getElementsByClassName('alvo')
    let td = document.createElement('td')
    td.classList.add(`cor${num}`)
    document.getElementsByClassName('alvo')[index.length-1].appendChild(td)
}

function resetar(numero){
    document.getElementById('dica').innerHTML = `${numeroSecreto[0]}${numeroSecreto[1]}${numeroSecreto[2]}${numeroSecreto[3]}`
    numeroSecreto.length = 0
    for(let index=0; index<numero.length; index++){
        numero[index].value = ''
    }
}


function ganhar(){
    document.getElementById('final-jogo').innerHTML = 'PARABENS VOCÊ GANHOU !!!!'
    document.getElementById('inicio-fim').style.display = 'block'
}

function perder(){
    document.getElementById('final-jogo').innerHTML = 'VOCÊ PERDEU !!!!'
    document.getElementById('inicio-fim').style.display = 'block'
}

function finalizar(){
    document.getElementsByClassName('numero-secreto')[0].focus()
    document.getElementById('tabela').innerHTML=''
    tentativa = 8
    document.getElementById('tentativas-restantes').innerHTML = tentativa
    numeroAleatorio.length = 0
}